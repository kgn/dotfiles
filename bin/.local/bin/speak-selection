#!/bin/bash
# Read selected text aloud using Piper TTS
# Uses primary selection (highlighted text) on Wayland

# Kill any existing piper/pw-play process (toggle behavior - press again to stop)
pkill -f "piper-tts.*lessac" 2>/dev/null && exit 0
pkill -f "pw-play.*/tmp/piper-speak" 2>/dev/null && exit 0

# Get primary selection (highlighted text)
text=$(wl-paste --primary 2>/dev/null)

if [ -n "$text" ]; then
    echo "$text" | piper-speak --speed 0.8 --bg
fi
